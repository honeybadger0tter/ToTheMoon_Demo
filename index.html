<!doctype html>
<html lang="en" data-theme="nostalgic">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>To The Moon Marketplace ‚Äî Demo</title>
  <meta name="description" content="Demo homepage concept for To The Moon Marketplace" />

  <!-- App / PWA bits -->
  <meta name="apple-mobile-web-app-title" content="To The Moon" />
  <meta name="application-name" content="To The Moon" />
  <meta name="theme-color" content="#0b0c10" />

  <!-- Favicons (files live in repo root) -->
  <link rel="icon" href="favicon.ico" sizes="any" />
  <link rel="icon" type="image/svg+xml" href="favicon.svg" />
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
  <link rel="manifest" href="site.webmanifest" />

  <style>
    :root{
      --bg: #f6f3ee;
      --ink: #1b1b1b;
      --muted:#5b5b5b;

      --card:#ffffffcc;
      --stroke:#00000014;
      --shadow: 0 20px 60px rgba(0,0,0,.10);

      --pill:#ffffffcc;
      --pillText:#1b1b1b;
      --pillStroke:#0000001a;

      --brandA:#ff4fb8;
      --brandB:#7a5cff;
      --accent:#ffd400;
      --accentInk:#151515;

      --headerBg: rgba(255,255,255,.72);
      --headerBlur: 12px;
    }

    html[data-theme="modern"]{
      --bg:#0b0c10;
      --ink:#f5f7ff;
      --muted:#b8bed6;

      --card: rgba(255,255,255,.08);
      --stroke:#ffffff14;
      --shadow: 0 24px 70px rgba(0,0,0,.45);

      --pill: rgba(255,255,255,.10);
      --pillText:#f5f7ff;
      --pillStroke:#ffffff22;

      --brandA:#39d0ff;
      --brandB:#a855ff;
      --accent:#ffd400;
      --accentInk:#121212;

      --headerBg: rgba(10,12,18,.55);
      --headerBlur: 14px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: var(--bg);
      color: var(--ink);
      line-height:1.35;
      overflow-x:hidden;
    }

    a{color:inherit}

    .wrap{max-width:1100px;margin:0 auto;padding:0 18px}

    /* Header */
    header{
      position: sticky;
      top: 0;
      z-index: 50;
      background: var(--headerBg);
      backdrop-filter: blur(var(--headerBlur));
      border-bottom:1px solid var(--stroke);
    }

    .bar{
      display:flex;
      align-items:center;
      gap:14px;
      padding: 10px 0;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      min-width: 210px; /* helps keep nav on one line */
    }

    .logo{
      width: 64px;   /* enlarged per request */
      height: 64px;
      border-radius: 16px;
      background: #fff;
      box-shadow: 0 10px 30px rgba(0,0,0,.10);
      border:1px solid var(--stroke);
      overflow:hidden;
      display:grid;
      place-items:center;
      flex:0 0 auto;
    }
    .logo img{width:100%;height:100%;object-fit:cover}

    .brand h1{
      margin:0;
      font-size: 18px;
      letter-spacing: .2px;
      line-height:1.1;
    }
    .brand .sub{
      margin:0;
      font-size: 12px;
      color: var(--muted);
    }

    nav{
      display:flex;
      align-items:center;
      gap:10px;
      flex: 1 1 auto;
      overflow:hidden;
      white-space: nowrap;
    }
    nav a{
      text-decoration:none;
      font-size: 13px;
      padding: 8px 10px;
      border-radius: 999px;
      border:1px solid var(--pillStroke);
      background: var(--pill);
      color: var(--pillText);
      transition: transform .12s ease, background .12s ease;
    }
    nav a:hover{transform: translateY(-1px)}
    nav a.active{
      background: linear-gradient(135deg, var(--brandA), var(--brandB));
      border-color: transparent;
      color: #fff;
    }

    .cta{
      display:flex;
      align-items:center;
      gap:10px;
      flex: 0 0 auto;
    }
    .pill{
      font-size: 12px;
      padding: 8px 12px;
      border-radius: 999px;
      border:1px solid var(--pillStroke);
      background: var(--pill);
      color: var(--pillText);
      box-shadow: 0 10px 30px rgba(0,0,0,.08);
      cursor:pointer;
      user-select:none;
    }
    .pill.primary{
      background: var(--accent);
      border-color: rgba(0,0,0,.12);
      color: var(--accentInk);
      font-weight: 700;
    }

    /* Sections */
    .hero{
      position: relative;
      padding: 34px 0 18px;
    }

    .heroGrid{
      display:grid;
      grid-template-columns: 1.25fr .75fr;
      gap: 18px;
      align-items: stretch;
    }
    @media (max-width: 900px){
      .heroGrid{grid-template-columns: 1fr}
    }

    .card{
      background: var(--card);
      border:1px solid var(--stroke);
      border-radius: 22px;
      box-shadow: var(--shadow);
      padding: 18px;
      position: relative;
      overflow:hidden;
    }

    .kicker{
      display:flex;
      align-items:center;
      gap:10px;
      margin-bottom: 12px;
    }
    .emoji{
      width: 44px;
      height: 44px;
      border-radius: 14px;
      display:grid;
      place-items:center;
      background: rgba(255,255,255,.55);
      border:1px solid rgba(0,0,0,.08);
      font-size: 22px;
    }
    html[data-theme="modern"] .emoji{
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.18);
    }

    h2{margin:0 0 8px;font-size: 22px}
    p{margin:0 0 10px;color: var(--muted); font-size: 14px}

    .upload{
      display:grid;
      gap: 10px;
      margin-top: 12px;
    }
    .drop{
      border: 2px dashed rgba(0,0,0,.18);
      border-radius: 18px;
      padding: 16px;
      background: rgba(255,255,255,.55);
      cursor:pointer;
      transition: transform .12s ease;
      position: relative;
      overflow:hidden;
    }
    html[data-theme="modern"] .drop{
      background: rgba(255,255,255,.06);
      border-color: rgba(255,255,255,.22);
    }
    .drop:hover{transform: translateY(-1px)}
    .drop strong{display:block;margin-bottom:6px}
    .row{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items:center;
    }
    input[type="text"], select{
      padding: 10px 12px;
      border-radius: 12px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.70);
      color: var(--ink);
      outline:none;
      min-width: 180px;
      flex:1 1 auto;
    }
    html[data-theme="modern"] input[type="text"], html[data-theme="modern"] select{
      background: rgba(255,255,255,.08);
      border-color: rgba(255,255,255,.18);
      color: var(--ink);
    }

    .progressWrap{
      height: 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.08);
      overflow:hidden;
      border:1px solid rgba(0,0,0,.08);
    }
    html[data-theme="modern"] .progressWrap{
      background: rgba(255,255,255,.10);
      border-color: rgba(255,255,255,.14);
    }

    .barFill{
      height: 100%;
      width: 0%;
      border-radius: 999px;
      background: linear-gradient(90deg, var(--brandA), var(--brandB));
      transition: width .2s ease;
    }

    /* Gallery */
    .sectionTitle{
      display:flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 10px;
      margin: 22px 0 12px;
    }
    .sectionTitle h3{margin:0;font-size: 16px}
    .sectionTitle .hint{margin:0;color: var(--muted);font-size: 12px}

    .masonry{
      column-count: 4;
      column-gap: 12px;
    }
    @media (max-width: 980px){ .masonry{column-count:3} }
    @media (max-width: 720px){ .masonry{column-count:2} }
    @media (max-width: 460px){ .masonry{column-count:1} }

    .masonryItem{
      break-inside: avoid;
      margin: 0 0 12px;
      border-radius: 18px;
      overflow:hidden;
      border:1px solid var(--stroke);
      box-shadow: 0 14px 30px rgba(0,0,0,.10);
      background: rgba(255,255,255,.55);
    }
    html[data-theme="modern"] .masonryItem{
      background: rgba(255,255,255,.06);
      box-shadow: 0 16px 40px rgba(0,0,0,.40);
    }

    .masonryItem img{
      width:100%;
      height:auto;
      display:block;
    }

    /* Modal */
    .overlay{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.55);
      display:none;
      align-items:center;
      justify-content:center;
      z-index: 200;
      padding: 16px;
    }
    .overlay.show{display:flex}
    .modal{
      width:min(740px, 96vw);
      background: var(--card);
      border:1px solid var(--stroke);
      border-radius: 22px;
      box-shadow: 0 28px 90px rgba(0,0,0,.45);
      overflow:hidden;
      position:relative;
    }
    .modalHead{
      padding: 14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      border-bottom:1px solid var(--stroke);
    }
    .modalHead strong{font-size: 14px}
    .closeBtn{
      border:none;
      background: transparent;
      color: var(--ink);
      font-size: 20px;
      cursor:pointer;
      padding: 6px 10px;
      border-radius: 12px;
    }
    .modalBody{padding: 14px 16px}
    .modalBody p{margin:0 0 10px}
    .modalBody ul{margin:8px 0 0 18px;color: var(--muted);font-size: 13px}

    /* Toast */
    .toast{
      position:fixed;
      left: 18px;
      bottom: 18px;
      z-index: 300;
      padding: 10px 12px;
      border-radius: 14px;
      background: var(--card);
      border:1px solid var(--stroke);
      box-shadow: 0 18px 60px rgba(0,0,0,.25);
      font-size: 13px;
      display:none;
      max-width: min(520px, 92vw);
    }
    .toast.show{display:block}

    /* Demo controls (bottom-right) */
    .demoControls{
      position:fixed;
      right: 14px;
      bottom: 14px;
      z-index: 250;
      display:flex;
      flex-direction: column;
      gap: 8px;
      align-items:flex-end;
      pointer-events:none; /* only buttons clickable */
    }
    .demoControls button{
      pointer-events:auto;
      border:none;
      border-radius: 999px;
      padding: 9px 12px;
      font-size: 12px;
      cursor:pointer;
      background: rgba(0,0,0,.08);
      color: var(--ink);
      border:1px solid var(--stroke);
      backdrop-filter: blur(10px);
    }
    html[data-theme="modern"] .demoControls button{
      background: rgba(255,255,255,.10);
      border-color: rgba(255,255,255,.18);
      color: var(--ink);
    }
    .demoControls button.faint{opacity:.25}
    .demoControls button:hover{opacity:1}

    /* Sparkles canvas */
    #sparkleCanvas{
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events:none;
      opacity: .35;
      mix-blend-mode: screen;
    }
    html[data-theme="nostalgic"] #sparkleCanvas{opacity:.20}
    html[data-theme="modern"] #sparkleCanvas{opacity:.35}

    main{position:relative;z-index:2}
  </style>
</head>

<body>
  <canvas id="sparkleCanvas"></canvas>

  <header>
    <div class="wrap">
      <div class="bar">
        <div class="brand">
          <div class="logo">
            <img src="assets/ttmm-logo.png" alt="To The Moon logo" onerror="this.style.display='none'; this.parentElement.textContent='üåô';" />
          </div>
          <div>
            <h1>To The Moon</h1>
            <p class="sub">Marketplace demo kit (v4)</p>
          </div>
        </div>

        <nav aria-label="Primary">
          <a class="active" href="index.html">Home</a>
          <a href="shop.html">Shop</a>
          <a href="rewards.html">Rewards</a>
          <a href="sweet-story.html">Sweet Story</a>
          <a href="events.html">Events</a>
          <a href="contact.html">Contact</a>
        </nav>

        <div class="cta">
          <div class="pill" id="sparkleBtn" title="Cycle sparkle modes">‚ú® Starburst</div>
          <div class="pill primary" id="orderBtn">Upload & Order</div>
        </div>
      </div>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="wrap">
        <div class="heroGrid">
          <div class="card">
            <div class="kicker">
              <div class="emoji">üç¨</div>
              <div>
                <h2>Nostalgia you can taste.</h2>
                <p>Rare candy, throwback snacks, and ‚Äúhow is this still real?‚Äù collectibles ‚Äî all in one clean marketplace.</p>
              </div>
            </div>

            <div class="upload" id="uploadCard">
              <div class="drop" id="dropZone">
                <strong>Drop files here (or click to choose)</strong>
                <p>Demo upload: shows progress, stores your name + delivery preference, and kicks a cute confirmation toast.</p>
                <input id="fileInput" type="file" multiple hidden />
                <div class="progressWrap" style="margin-top:10px;">
                  <div class="barFill" id="progressFill"></div>
                </div>
              </div>

              <div class="row">
                <input type="text" id="nameInput" placeholder="Your name (letters or emojis ‚ú®üòÉ)" maxlength="32" />
                <select id="deliverySelect">
                  <option value="local">Pickup (Fort Lauderdale)</option>
                  <option value="courier">Uber Courier (future integration)</option>
                  <option value="ship">Shipping</option>
                </select>
                <div class="pill" id="demoCheckoutBtn">Demo checkout</div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="kicker">
              <div class="emoji">üß©</div>
              <div>
                <h2>Daily hook (demo)</h2>
                <p>Placeholder for your ‚Äúcome back tomorrow‚Äù mechanic: puzzle, riddle, drop, reward, whatever.</p>
              </div>
            </div>
            <p style="margin-top:8px;">Today‚Äôs demo prompt:</p>
            <p><strong>‚ÄúWhat candy would you bring to the moon?‚Äù</strong> (No wrong answers. Except black licorice. I said what I said.)</p>
            <div class="row" style="margin-top:10px;">
              <div class="pill" id="themeBtn">Theme</div>
              <div class="pill" id="openRewardsBtn">Show rewards popup</div>
            </div>
          </div>
        </div>

        <div class="sectionTitle">
          <h3>Gallery</h3>
          <p class="hint">If an image is missing, it‚Äôll just quietly skip it.</p>
        </div>

        <div class="masonry" id="galleryMasonry"></div>
      </div>
    </section>
  </main>

  <!-- Rewards Modal -->
  <div class="overlay" id="overlay">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modalHead">
        <strong id="modalTitle">Rewards (demo)</strong>
        <button class="closeBtn" id="closeModalBtn" aria-label="Close">√ó</button>
      </div>
      <div class="modalBody">
        <p>Welcome back! Here‚Äôs the ‚Äúfirst-time visitor‚Äù popup behavior.</p>
        <ul>
          <li>Shows once per browser unless Reset is clicked.</li>
          <li>Tracks theme + sparkle mode.</li>
          <li>Made to feel ‚Äúpremium playful,‚Äù not MySpace glitter-bomb.</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast"></div>

  <!-- Bottom-right demo controls -->
  <div class="demoControls">
    <button id="resetDemoBtn">Reset demo</button>
    <button id="themeBtn2" class="faint">Theme</button>
  </div>

  <script>
    // Helpers
    const $ = (q) => document.querySelector(q);

    const toastEl = $('#toast');
    let toastTimer = null;
    function toast(msg){
      if(!toastEl) return;
      toastEl.textContent = msg;
      toastEl.classList.add('show');
      clearTimeout(toastTimer);
      toastTimer = setTimeout(() => toastEl.classList.remove('show'), 2400);
    }

    // Modal
    const overlay = $('#overlay');
    const openRewardsBtn = $('#openRewardsBtn');
    const closeModalBtn = $('#closeModalBtn');

    function openModal(){
      if(!overlay) return;
      overlay.classList.add('show');
    }
    function closeModal(){
      if(!overlay) return;
      overlay.classList.remove('show');
    }

    if(openRewardsBtn) openRewardsBtn.addEventListener('click', openModal);
    if(closeModalBtn) closeModalBtn.addEventListener('click', closeModal);
    if(overlay) overlay.addEventListener('click', (e) => { if(e.target === overlay) closeModal(); });

    // Show rewards modal once
    const rewardsSeen = localStorage.getItem('ttmm_rewards_seen');
    if(!rewardsSeen){
      setTimeout(() => {
        openModal();
        localStorage.setItem('ttmm_rewards_seen', '1');
      }, 900);
    }

    // Upload demo
    const dropZone = $('#dropZone');
    const fileInput = $('#fileInput');
    const progressFill = $('#progressFill');

    function fakeProgress(){
      if(!progressFill) return;
      progressFill.style.width = '0%';
      let p = 0;
      const t = setInterval(() => {
        p += Math.random() * 18;
        if(p >= 100){ p = 100; clearInterval(t); toast('Upload complete. (Demo vibes only) üöÄ'); }
        progressFill.style.width = p + '%';
      }, 120);
    }

    function handleFiles(files){
      const count = files?.length || 0;
      toast(count ? `Got ${count} file(s). Printing moon dust‚Ä¶ üåô` : 'No files picked.');
      fakeProgress();
    }

    if(dropZone && fileInput){
      dropZone.addEventListener('click', () => fileInput.click());
      dropZone.addEventListener('dragover', (e) => { e.preventDefault(); dropZone.style.transform = 'translateY(-1px)'; });
      dropZone.addEventListener('dragleave', () => { dropZone.style.transform = ''; });
      dropZone.addEventListener('drop', (e) => {
        e.preventDefault();
        dropZone.style.transform = '';
        handleFiles(e.dataTransfer.files);
      });
      fileInput.addEventListener('change', (e) => handleFiles(e.target.files));
    }

    const demoCheckoutBtn = $('#demoCheckoutBtn');
    const nameInput = $('#nameInput');
    const deliverySelect = $('#deliverySelect');
    if(demoCheckoutBtn){
      demoCheckoutBtn.addEventListener('click', () => {
        const name = (nameInput?.value || 'Friend').trim().slice(0,32);
        const delivery = deliverySelect?.value || 'local';
        toast(`Queued for ${name}. Delivery: ${delivery}. ‚úÖ`);
      });
    }

    // Theme toggle (persisted)
    function setTheme(theme){
      document.documentElement.setAttribute('data-theme', theme);
      localStorage.setItem('ttmm_theme', theme);
      // refresh sparkles with theme preference
      sparkle.mode = (theme === 'nostalgic') ? 'starburst' : 'glitter';
      sparkle.render(true);
    }

    function toggleTheme(){
      const cur = document.documentElement.getAttribute('data-theme') || 'nostalgic';
      setTheme(cur === 'nostalgic' ? 'modern' : 'nostalgic');
      toast(`‚ú® Theme: ${document.documentElement.getAttribute('data-theme')}`);
    }

    const themeBtn = $('#themeBtn');
    const themeBtn2 = $('#themeBtn2');
    if(themeBtn) themeBtn.addEventListener('click', toggleTheme);
    if(themeBtn2) themeBtn2.addEventListener('click', toggleTheme);

    // Reset demo
    const resetDemoBtn = $('#resetDemoBtn');
    function resetDemo(){
      localStorage.removeItem('ttmm_rewards_seen');
      localStorage.removeItem('ttmm_theme');
      localStorage.removeItem('ttmm_sparkle_mode');
      setTheme('nostalgic');
      setTimeout(openModal, 600);
      toast('Reset complete. (Windows activation vibes restored üòå)');
    }
    if(resetDemoBtn) resetDemoBtn.addEventListener('click', resetDemo);

    // restore theme
    const savedTheme = localStorage.getItem('ttmm_theme');
    if(savedTheme === 'modern' || savedTheme === 'nostalgic') setTheme(savedTheme);

    /* =========================
        Gallery (robust loading)
        - If a file isn't found, it won't show.
    ========================== */
    const galleryMasonry = document.getElementById('galleryMasonry');

    const galleryFiles = [
      'assets/gallery-01.jpg',
      'assets/gallery-02.jpg',
      'assets/gallery-03.jpg',
      'assets/gallery-04.jpg',
      'assets/gallery-05.jpg',
      'assets/gallery-06.jpg',
      'assets/gallery-07.jpg',
      'assets/gallery-08.jpg',
    ];

    function addPhoto(src){
      const wrap = document.createElement('div');
      wrap.className = 'masonryItem';

      const img = document.createElement('img');
      img.className = 'photo';
      img.alt = 'Store photo';
      img.loading = 'lazy';
      img.src = src;

      img.onerror = () => {
        // quietly skip missing images so the demo never looks broken
        wrap.remove();
      };

      wrap.appendChild(img);
      galleryMasonry.appendChild(wrap);
    }

    if(galleryMasonry){
      galleryFiles.forEach(addPhoto);
    }

    /* =========================
        Sparkles (NO external files)
        Modes: glitter | starburst | confetti
        Default: starburst (nostalgic), glitter (modern)
        You can cycle modes with Ctrl+Shift+S (hidden dev trick).
    ========================== */
    const canvas = document.getElementById('sparkleCanvas');
    const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    const sparkle = {
      mode: localStorage.getItem('ttmm_sparkle_mode') || 'starburst',
      dpr: Math.max(1, Math.min(2, window.devicePixelRatio || 1)),
      w: 0,
      h: 0,
      ctx: null,
      points: [],
      lastT: 0,
      init(){
        if(!canvas || prefersReduced) return;
        this.ctx = canvas.getContext('2d');
        this.resize();
        this.seed();
        this.render(true);
        window.addEventListener('resize', () => this.resize());
        requestAnimationFrame((t) => this.tick(t));
      },
      resize(){
        if(!this.ctx) return;
        const rect = canvas.getBoundingClientRect();
        this.w = Math.max(1, Math.floor(rect.width));
        this.h = Math.max(1, Math.floor(rect.height));
        canvas.width = Math.floor(this.w * this.dpr);
        canvas.height = Math.floor(this.h * this.dpr);
        this.ctx.setTransform(this.dpr,0,0,this.dpr,0,0);
      },
      seed(){
        this.points = [];
        const count = Math.floor((this.w * this.h) / 22000);
        for(let i=0;i<count;i++){
          this.points.push(this.makePoint(true));
        }
      },
      makePoint(isInit=false){
        const x = Math.random()*this.w;
        const y = Math.random()*this.h;
        const s = (this.mode === 'glitter') ? (0.6 + Math.random()*1.4) : (0.9 + Math.random()*2.2);
        const v = (this.mode === 'confetti') ? (12 + Math.random()*26) : (6 + Math.random()*18);
        const a = isInit ? Math.random() : 0;
        return {x,y,s,v,a,rot:Math.random()*Math.PI*2,life: 0.6+Math.random()*1.6};
      },
      cycleMode(){
        const order = ['glitter','starburst','confetti'];
        const cur = this.mode;
        const next = order[(order.indexOf(cur)+1) % order.length];
        this.mode = next;
        localStorage.setItem('ttmm_sparkle_mode', next);
        toast(`‚ú® Sparkles: ${next}`);
        this.seed();
      },
      tick(t){
        if(!this.ctx) return;
        const dt = Math.min(0.05, (t - this.lastT) / 1000 || 0.016);
        this.lastT = t;
        this.render(false, dt);
        requestAnimationFrame((tt) => this.tick(tt));
      },
      render(force=false, dt=0.016){
        const ctx = this.ctx;
        if(!ctx) return;
        ctx.clearRect(0,0,this.w,this.h);

        for(let i=0;i<this.points.length;i++){
          const p = this.points[i];
          p.a += dt / p.life;
          if(p.a >= 1){
            this.points[i] = this.makePoint(false);
            continue;
          }

          // drift
          p.y += p.v * dt;
          p.x += Math.sin((p.y/60) + i) * 6 * dt;

          // wrap
          if(p.y > this.h + 30) p.y = -20;
          if(p.x < -30) p.x = this.w + 20;
          if(p.x > this.w + 30) p.x = -20;

          const alpha = (1 - p.a) * 0.85;
          ctx.globalAlpha = alpha;

          if(this.mode === 'glitter'){
            // tiny glowing dots
            ctx.beginPath();
            ctx.arc(p.x, p.y, p.s, 0, Math.PI*2);
            ctx.fillStyle = 'rgba(255,255,255,1)';
            ctx.fill();
          }else if(this.mode === 'starburst'){
            // little star crosses
            ctx.save();
            ctx.translate(p.x, p.y);
            ctx.rotate(p.rot);
            ctx.strokeStyle = 'rgba(255,255,255,1)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(-p.s*2, 0);
            ctx.lineTo(p.s*2, 0);
            ctx.moveTo(0, -p.s*2);
            ctx.lineTo(0, p.s*2);
            ctx.stroke();
            ctx.restore();
          }else{
            // confetti micro-rects
            ctx.save();
            ctx.translate(p.x, p.y);
            ctx.rotate(p.rot);
            ctx.fillStyle = 'rgba(255,255,255,1)';
            ctx.fillRect(-p.s*1.2, -p.s*0.6, p.s*2.4, p.s*1.2);
            ctx.restore();
          }
        }

        ctx.globalAlpha = 1;
      }
    };

    sparkle.init();

    // Sparkle UI
    const sparkleBtn = $('#sparkleBtn');
    if(sparkleBtn){
      sparkleBtn.addEventListener('click', () => sparkle.cycleMode());
    }

    // Hidden dev shortcut: Ctrl+Shift+S cycles sparkle modes
    window.addEventListener('keydown', (e) => {
      if(e.ctrlKey && e.shiftKey && (e.key === 'S' || e.key === 's')){
        e.preventDefault();
        sparkle.cycleMode();
      }
    });

    // Order button toast (demo)
    const orderBtn = $('#orderBtn');
    if(orderBtn){
      orderBtn.addEventListener('click', () => toast('Order flow would start here (demo). üöÄ'));
    }
  </script>
</body>
</html>
